<html>
<head>
<link rel="shortcut icon" href="icoon.ico" />
</head>
<title>ARM-RUN EDITOR</title>
<link rel="stylesheet" type="text/css" href="pagestyle.css">
<!--<link rel="stylesheet" type="text/css" href="navstyle.css">-->

<body>

<nav>
<img src="logo.png">
<button id="assemble" onclick="map_commands()">Assemble</button>
<button id="reset_reg" onclick="reset_regs()">Reset</button>
<button id="step_up" onclick="to_up()">Move up</button>
<button id="step_down" onclick="to_down()">Move down</button><br>

<div id = "rads">
<input type="radio" id="format_hex" name="typef" value="Hex"  onclick="change_format()" />Hex
<input type="radio" id="format_bin" name="typef" value="Bin"  onclick="change_format()" />Bin
<input type="radio" id="format_dec" name="typef" value="Dec"  checked="checked" onclick="change_format()" />Dec<br />
</div>

<div id="instructions_typed_tag">No. of instructions:</div>
<div id="instructions_typed">0</div>

<div id="instructions_typed_ex_tag">No. of instructions executed:</div>
<div id="instructions">0</div>
 
<div id="line_tag">Line number:</div>
<input type="text" id="line_number" name="eee" size="1">

<table id ="regs" border="1">
  <tr>
    <th>Register</th>
    <th>Value</th>
  </tr>
  <tr>
    <td>r0</td>
    <td id="r0"></td>
  </tr>
  <tr>
    <td>r1</td>
    <td id="r1"></td>
  </tr>
  <tr>
    <td>r2</td>
    <td id="r2"></td>
  </tr>
  <tr>
    <td>r3</td>
    <td id="r3"></td>
  </tr>
  <tr>
    <td>r4</td>
    <td id="r4"></td>
  </tr>
  <tr>
    <td>r5</td>
    <td id="r5"></td>
  </tr>
  <tr>
    <td>r6</td>
    <td id="r6"></td>
  </tr>
  <tr>
    <td>r7</td>
    <td id="r7"></td>
  </tr>
  <tr>
    <td>r8</td>
    <td id="r8"></td>
  </tr>
  <tr>
    <td>r9</td>
    <td id="r9"></td>
  </tr>
  <tr>
    <td>r10</td>
    <td id="r10"></td>
  </tr>
  <tr>
    <td>r11</td>
    <td id="r11"></td>
  </tr>
  <tr>
    <td>r12</td>
    <td id="r12"></td>
  </tr>
  <tr>
    <td>r13[sp]</td>
    <td id="sp"></td>
  </tr>
  <tr>
    <td>r14[lr]</td>
    <td id="lr"></td>
  </tr>
  <tr>
    <td>r15[pc]</td>
    <td id="pc"></td>
  </tr>
</table>

<div id="st_tag">Stack</div>

<table id="stack" border="1">

  <tr>
	<td id="s0">0</td>
    <td id="i0"></td>
  </tr>
  <tr>
	 <td id="s1">4</td>
    <td id="i1"></td>
  </tr>
  <tr>
	  <td id="s2">8</td>
    <td id="i2"></td>
  </tr>
  <tr>
	  <td id="s3">12</td>
	<td id="i3"></td>
  </tr>
  <tr>
	  <td id="s4">16</td>
	<td id="i4"></td>
  </tr>
  <tr>
	  <td id="s5">20</td>
    <td id="i5"></td>
  </tr>
  <tr>
	  <td id="s6">24</td>
	<td id="i6"></td>
  </tr>
  <tr>
	  <td id="s7">28</td>
    <td id="i7"></td>
  </tr>
  <tr>
	  <td id="s8">32</td>
    <td id="i8"></td>
  </tr>
  <tr>
	  <td id="s9">36</td>
    <td id="i9"></td>
  </tr>
  <tr>
	  <td id="s10">40</td>
	<td id="i10"></td>
  </tr>
  <tr>
	  <td id="s11">44</td>
	<td id="i11"></td>
  </tr>
  <tr>
	  <td id="s12">48</td>
    <td id="i12"></td>
  </tr>
  <tr>
	  <td id="s13">52</td>
	<td id="i13"></td>
  </tr>
  <tr>
	  <td id="s14">56</td>
	<td id="i14"></td>
  </tr>
  <tr>
	  <td id="s15">60</td>
	<td id="i15"></td>
  </tr>
</table>

<div id="data_mem">Data memory</div>
<table id="data_memory">
  <tr>
    <th>Location</th>
    <th>Label</th>
    <th>Value</th>
  </tr>
  <tr>
    <td>00</td>
    <td id="n00">-</td>
    <td id="d00">-</td>
  </tr>
  <tr>
    <td>01</td>
    <td id="n01">-</td>
    <td id="d01">-</td>
  </tr>
  <tr>
    <td>02</td>
    <td id="n02">-</td>
    <td id="d02">-</td>
  </tr>
  <tr>
    <td>03</td>
    <td id="n03">-</td>
    <td id="d03">-</td>
  </tr>
 </table>
</nav>


<header> Enter your source code	or upload a file from your computer</header>

<img id="editpng" src="edit.png">
<div id="editdiv">Source code:</div>

<img id="inpng" src="input.png">
<div id="indiv">Standard input:</div>

<!--img id=outputpng" src="output.png"-->
<div id="outdiv">Output:</div>

<table id = "dfr">
	
<tr>
	
<td colspan="3">
<div id="textin">@Enter your code here

	.text		
	.global main
main:                        
	
	.data 	 
</div>

<div id="div1">
</td>
</tr>

<tr>
<td><input id="inputFileNameToSaveAs"></input></td>
<td><button id="savetext" onclick="saveTextAsFile()">Save output to File:</button></td>
</tr>

<tr>
<td><input type="file" id="fileToLoad" class="custom-file-input"></td>
<td><button id="loadtext" onclick="loadFileAsText();">Load Selected File</button><td>
</tr>
</div>

</table>

<div id="outpane">

<textarea id="theOut" name="toCompiler" style="display:none"></textarea>
<input id="submit" type="button" value="Assemble/Run" />
<textarea id="stin" name="toComp" style="resize:none; display; background-color: transparent" placeholder="Standard input" ></textarea>

</div>

<textarea readonly style="resize:none; color:#0431B4; background-color: #CECEF6;" placeholder="Standard output" id="out" name="comment" ;></textarea>
<!--<textarea readonly style="resize:none; color:#0431B4; background-color: #CECEF6;" placeholder="Instruction memory" id="inmem" name="instructions_mem" ;></textarea>-->

<div id="inmem">
</div>
<footer>
Developed by ARM 2
</footer>

<script type = "text/javascript" src="jquery-1.11.1.js"></script>
<script type = "text/javascript" src="ajax.js"></script>
<script type = "text/javascript" src="pro1.js"></script>
<script type = "text/javascript" src="insmem.js"></script>

<script src="src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("textin");
    editor.setTheme("ace/theme/github");
    editor.getSession().setMode("ace/mode/assembly_x86");
   // document.getElementById('editor').style.fontSize='20px';
   // editor.getSession().setTabSize(8);
   var edinm = ace.edit("inmem");
   edinm.setTheme("ace/theme/github");
</script>

<script type='text/javascript'>

function saveTextAsFile()
{
	var textToWrite = document.getElementById("textin").value;

	var textFileAsBlob = new Blob([textToWrite], {type:'text/plain'});
	var fileNameToSaveAs = document.getElementById("inputFileNameToSaveAs").value;

	var downloadLink = document.createElement("a");
	downloadLink.download = fileNameToSaveAs;
	downloadLink.innerHTML = "Download File";
	if (window.webkitURL != null)
	{
		// Chrome allows the link to be clicked
		// without actually adding it to the DOM.
		downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
	}
	else
	{
		// Firefox requires the link to be added to the DOM
		// before it can be clicked.
		downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
		downloadLink.onclick = destroyClickedElement;
		downloadLink.style.display = "none";
		document.body.appendChild(downloadLink);
	}

	downloadLink.click();
}

function destroyClickedElement(event)
{
	document.body.removeChild(event.target);
}

function loadFileAsText()
{
	var fileToLoad = document.getElementById("fileToLoad").files[0];

	var fileReader = new FileReader();
	fileReader.onload = function(fileLoadedEvent) 
	{
		textin.getSelectedText = function() {
    		this.session.getTextRange(this.getSelectionRange())
} 
		var textFromFileLoaded = fileLoadedEvent.target.result;
		editor.setValue(textFromFileLoaded);
	};
	fileReader.readAsText(fileToLoad, "UTF-4");
}
	
</script>

</body>
</html>
